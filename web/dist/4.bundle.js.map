{"version":3,"sources":["webpack:///./src/components/pages/contribution/speak/audio-ios.ts","webpack:///./src/components/pages/contribution/speak/audio-web.ts","webpack:///./src/components/terms-modal.tsx","webpack:///./src/confirm/confirm.ts"],"names":[],"mappings":"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","file":"4.bundle.js","sourcesContent":["import { isNativeIOS } from '../../../../utility';\nimport { AudioInfo } from './audio-web';\nimport confirm from '../../../../confirm/confirm';\n\nconst LEVELS_THROTTLE = 50;\n\ndeclare var webkit: any;\ndeclare var vcopensettings: any;\n\nexport default class AudioIOS {\n  postMessage: Function;\n  pendingStart: Function;\n  pendingStartError: Function;\n  volumeCallback: Function;\n  lastUpdate: number;\n\n  static AUDIO_TYPE: string = 'audio/m4a;base64';\n  last: AudioInfo;\n\n  clear(): void {\n    this.last = null;\n  }\n\n  // Microphone is definitely supported on iOS.\n  isMicrophoneSupported() {\n    return true;\n  }\n\n  isAudioRecordingSupported() {\n    return true;\n  }\n\n  // For audio src URL, we need to trick webkit into\n  // thinking this is an mp4 base64 encoding.\n  static AUDIO_TYPE_URL: string = 'audio/mp4;base64';\n\n  private handleNativeMessage(msg: string): void {\n    if (msg === 'nomicpermission') {\n      confirm(\n        'Please allow microphone access to record your voice.',\n        'Go to Settings',\n        'Cancel'\n      ).then(gotoSettings => {\n        if (gotoSettings) {\n          vcopensettings();\n        }\n      });\n    } else if (msg === 'capturestarted') {\n      if (this.pendingStart) {\n        let cb = this.pendingStart;\n        this.pendingStart = null;\n        this.pendingStartError = null;\n        cb();\n      }\n    } else if (msg === 'errorrecording') {\n      if (this.pendingStart) {\n        let cb = this.pendingStartError;\n        this.pendingStart = null;\n        this.pendingStartError = null;\n        cb('Unable to start recording');\n      }\n    } else {\n      console.log('unhandled native message', msg);\n    }\n  }\n\n  constructor() {\n    // Make sure we are in the right context before we allow instantiation.\n    if (!isNativeIOS()) {\n      throw new Error('cannot use ios audio in web app');\n    }\n\n    // Native will call this function with decibels from -120 to 0.\n    this.lastUpdate = Date.now();\n    window['levels'] = (decibels: string) => {\n      if (!this.volumeCallback) {\n        return;\n      }\n\n      let now = Date.now();\n      if (now - this.lastUpdate > LEVELS_THROTTLE) {\n        this.lastUpdate = now;\n        // Scale and shift to get a nice sound curve.\n        let volume = (parseInt(decibels, 10) + 70) * 1.5;\n        this.volumeCallback(volume);\n      }\n    };\n\n    // Handle any messages coming from native.\n    window['nativemsgs'] = this.handleNativeMessage.bind(this);\n\n    // Store our native message bridge for later.\n    let messenger = webkit.messageHandlers['scriptHandler'];\n    this.postMessage = messenger.postMessage.bind(messenger);\n\n    // For now, we will always use portrait mode for the app.\n    this.postMessage('lockportrait');\n  }\n\n  /**\n   * Initialize the recorder. For this iOS implementation, this is a no-op.\n   *\n   * @returns A Promise that resolves to `true` immediately.\n   */\n  async init(): Promise<boolean> {\n    return true;\n  }\n\n  setVolumeCallback(cb: Function) {\n    this.volumeCallback = cb;\n  }\n\n  start(): Promise<void> {\n    return new Promise<void>((res, rej) => {\n      this.pendingStart = res;\n      this.pendingStartError = rej;\n      this.postMessage('startCapture');\n    });\n  }\n\n  stop(): Promise<AudioInfo> {\n    return new Promise((res: Function, rej: Function) => {\n      // Liten for the next data call from Native, that will\n      // have our sound data in base64 format.\n\n      window['uploadData'] = (data: string) => {\n        this.last = {\n          url: 'data:' + AudioIOS.AUDIO_TYPE_URL + ',' + data,\n          blob: new Blob([data], {\n            type: AudioIOS.AUDIO_TYPE,\n          }),\n        };\n        res(this.last);\n      };\n\n      this.postMessage('stopCapture');\n    });\n  }\n\n  release() {}\n\n  // We aren't using this for now, but this performs better\n  // than the base64 url for obvious reasons.\n  play(): void {\n    this.postMessage('playCapture');\n  }\n}\n","import { isNativeIOS } from '../../../../utility';\n\nconst AUDIO_TYPE = 'audio/ogg; codecs=opus';\n\ninterface BlobEvent extends Event {\n  data: Blob;\n}\n\nexport enum AudioError {\n  NOT_ALLOWED = 'NOT_ALLOWED',\n  NO_MIC = 'NO_MIC',\n  NO_SUPPORT = 'NO_SUPPORT',\n}\n\nexport interface AudioInfo {\n  url: string;\n  blob: Blob;\n}\n\nexport default class AudioWeb {\n  microphone: MediaStream;\n  analyzerNode: AnalyserNode;\n  audioContext: AudioContext;\n  recorder: any;\n  chunks: any[];\n  last: AudioInfo;\n  lastRecordingData: Blob;\n  lastRecordingUrl: string;\n  frequencyBins: Uint8Array;\n  volumeCallback: Function;\n  jsNode: any;\n\n  constructor() {\n    // Make sure we are in the right context before we allow instantiation.\n    if (isNativeIOS()) {\n      throw new Error('cannot use web audio in iOS app');\n    }\n\n    this.visualize = this.visualize.bind(this);\n  }\n\n  private isReady(): boolean {\n    return !!this.microphone;\n  }\n\n  private getMicrophone(): Promise<MediaStream> {\n    return new Promise(function(res: Function, rej: Function) {\n      function deny(error: MediaStreamError) {\n        rej(\n          ({\n            NotAllowedError: AudioError.NOT_ALLOWED,\n            NotFoundError: AudioError.NO_MIC,\n          } as { [errorName: string]: AudioError })[error.name] || error\n        );\n      }\n      function resolve(stream: MediaStream) {\n        res(stream);\n      }\n\n      if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n        navigator.mediaDevices\n          .getUserMedia({ audio: true })\n          .then(resolve, deny);\n      } else if (navigator.getUserMedia) {\n        navigator.getUserMedia({ audio: true }, resolve, deny);\n      } else if (navigator.webkitGetUserMedia) {\n        navigator.webkitGetUserMedia({ audio: true }, resolve, deny);\n      } else if (navigator.mozGetUserMedia) {\n        navigator.mozGetUserMedia({ audio: true }, resolve, deny);\n      } else {\n        // Browser does not support getUserMedia\n        rej(AudioError.NO_SUPPORT);\n      }\n    });\n  }\n\n  // Check all the browser prefixes for microhpone support.\n  isMicrophoneSupported() {\n    return (\n      (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) ||\n      navigator.getUserMedia ||\n      navigator.webkitGetUserMedia ||\n      navigator.mozGetUserMedia\n    );\n  }\n\n  // Check if audio recording is supported\n  isAudioRecordingSupported() {\n    return typeof MediaRecorder !== 'undefined';\n  }\n\n  private visualize() {\n    this.analyzerNode.getByteFrequencyData(this.frequencyBins);\n\n    let sum = 0;\n    for (var i = 0; i < this.frequencyBins.length; i++) {\n      sum += this.frequencyBins[i];\n    }\n\n    let average = sum / this.frequencyBins.length;\n\n    if (this.volumeCallback) {\n      this.volumeCallback(average);\n    }\n  }\n\n  private startVisualize() {\n    this.jsNode.onaudioprocess = this.visualize;\n  }\n\n  private stopVisualize() {\n    this.jsNode.onaudioprocess = undefined;\n    if (this.volumeCallback) {\n      this.volumeCallback(100);\n    }\n  }\n\n  setVolumeCallback(cb: Function) {\n    this.volumeCallback = cb;\n  }\n\n  /**\n   * Initialize the recorder, opening the microphone media stream.\n   *\n   * If microphone access is currently denied, the user is asked to grant\n   * access. Since these permission changes take effect only after a reload,\n   * the page is reloaded if the user decides to do so.\n   *\n   */\n  async init() {\n    if (this.isReady()) {\n      return;\n    }\n\n    const microphone = await this.getMicrophone();\n\n    this.microphone = microphone;\n    var audioContext = new AudioContext();\n    var sourceNode = audioContext.createMediaStreamSource(microphone);\n    var volumeNode = audioContext.createGain();\n    var analyzerNode = audioContext.createAnalyser();\n    var outputNode = audioContext.createMediaStreamDestination();\n\n    // Make sure we're doing mono everywhere.\n    sourceNode.channelCount = 1;\n    volumeNode.channelCount = 1;\n    analyzerNode.channelCount = 1;\n    outputNode.channelCount = 1;\n\n    // Connect the nodes together\n    sourceNode.connect(volumeNode);\n    volumeNode.connect(analyzerNode);\n    analyzerNode.connect(outputNode);\n\n    // and set up the recorder.\n    this.recorder = new MediaRecorder(outputNode.stream);\n\n    // Set up the analyzer node, and allocate an array for its data\n    // FFT size 64 gives us 32 bins. But those bins hold frequencies up to\n    // 22kHz or more, and we only care about visualizing lower frequencies\n    // which is where most human voice lies, so we use fewer bins\n    analyzerNode.fftSize = 128;\n    analyzerNode.smoothingTimeConstant = 0.96;\n    this.frequencyBins = new Uint8Array(analyzerNode.frequencyBinCount);\n\n    // Setup audio visualizer.\n    this.jsNode = audioContext.createScriptProcessor(256, 1, 1);\n    this.jsNode.connect(audioContext.destination);\n\n    // Another audio node used by the beep() function\n    var beeperVolume = audioContext.createGain();\n    beeperVolume.connect(audioContext.destination);\n\n    this.analyzerNode = analyzerNode;\n    this.audioContext = audioContext;\n  }\n\n  start(): Promise<void> {\n    if (!this.isReady()) {\n      console.error('Cannot record audio before microhphone is ready.');\n      return Promise.resolve();\n    }\n\n    return new Promise<void>((res: Function, rej: Function) => {\n      this.chunks = [];\n      this.recorder.ondataavailable = (e: BlobEvent) => {\n        this.chunks.push(e.data);\n      };\n\n      this.recorder.onstart = (e: Event) => {\n        this.clear();\n        res();\n      };\n\n      // We want to be able to record up to 60s of audio in a single blob.\n      // Without this argument to start(), Chrome will call dataavailable\n      // very frequently.\n      this.startVisualize();\n      this.recorder.start(20000);\n    });\n  }\n\n  stop(): Promise<AudioInfo> {\n    if (!this.isReady()) {\n      console.error('Cannot stop audio before microhphone is ready.');\n      return Promise.reject();\n    }\n\n    return new Promise((res: Function, rej: Function) => {\n      this.stopVisualize();\n\n      this.recorder.onstop = (e: Event) => {\n        let blob = new Blob(this.chunks, { type: AUDIO_TYPE });\n        this.last = {\n          url: URL.createObjectURL(blob),\n          blob: blob,\n        };\n        res(this.last);\n      };\n      this.recorder.stop();\n    });\n  }\n\n  release() {\n    if (this.microphone) {\n      for (const track of this.microphone.getTracks()) {\n        track.stop();\n      }\n    }\n    this.microphone = null;\n  }\n\n  clear() {\n    if (this.lastRecordingUrl) {\n      URL.revokeObjectURL(this.lastRecordingUrl);\n    }\n\n    this.lastRecordingData = null;\n    this.lastRecordingUrl = null;\n  }\n}\n","import * as React from 'react';\nimport {\n  LocalizationProps,\n  Localized,\n  withLocalization,\n} from 'fluent-react/compat';\nimport URLS from '../urls';\nimport { LocaleLink } from './locale-helpers';\nimport Modal from './modal/modal';\n\nconst TermsModal = ({\n  getString,\n  onAgree,\n  onDisagree,\n}: { onAgree: () => any; onDisagree: () => any } & LocalizationProps) => (\n  <Localized\n    id=\"review-terms\"\n    termsLink={<LocaleLink to={URLS.TERMS} blank />}\n    privacyLink={<LocaleLink to={URLS.PRIVACY} blank />}>\n    <Modal\n      buttons={{\n        [getString('terms-agree')]: onAgree,\n        [getString('terms-disagree')]: onDisagree,\n      }}\n    />\n  </Localized>\n);\nexport default withLocalization(TermsModal);\n","/**\n * Present a modal dialog (asynchronously). Usage:\n *\n *   const isConfirmed = await confirm('are you sure?', 'yes', 'no')\n *   if (!isConfirmed) { ... show error ... }\n *\n * @param label The main text/label for the dialog.\n * @param okLabel Label for the \"OK\" button.\n * @param cancelLabel Label for the \"Cancel\" button.\n * @returns A Promise that is resolved with `true` if user clicks the \"OK\" button,\n *    or resolved with `false` if user clicks the \"Cancel\" button.\n */\nexport default function confirm(\n  label: string,\n  okLabel: string,\n  cancelLabel: string\n) {\n  const element = document.createElement('div');\n  element.classList.add('confirm-modal');\n\n  const mainSection = document.createElement('div');\n  mainSection.classList.add('main-section');\n  element.appendChild(mainSection);\n\n  const labelElement = document.createElement('label');\n  labelElement.textContent = label;\n  mainSection.appendChild(labelElement);\n\n  const confirmButton = document.createElement('button');\n  confirmButton.id = 'confirm-confirm';\n  confirmButton.textContent = okLabel;\n  mainSection.appendChild(confirmButton);\n\n  const cancelButton = document.createElement('button');\n  cancelButton.id = 'confirm-cancel';\n  cancelButton.textContent = cancelLabel;\n  mainSection.appendChild(cancelButton);\n\n  function close() {\n    element.parentElement.removeChild(element);\n  }\n\n  return new Promise((resolve, reject) => {\n    document.body.appendChild(element);\n    confirmButton.addEventListener('click', () => {\n      close();\n      resolve(true);\n    });\n    cancelButton.addEventListener('click', () => {\n      close();\n      resolve(false);\n    });\n\n    // In the next loop, add the visible class so that we can animate the transition.\n    setTimeout(() => {\n      element.classList.add('visible');\n    });\n  });\n}\n"],"sourceRoot":""}